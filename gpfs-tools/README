
gpfsmapper

This is a small utility to aid the Storage team in easily generating multipath.conf
files and GPFS cluster configuration input.

BUILD and INSTALL

> perl Makefile.PL
> make
> make gpfsmapper

Copy gpfsmapper to a GPFS cluster host.

Write a configuration file that maps a 29 character disk array ID to a friendly name prefix:

> cat > gpfsmapper.conf <<EOF
360060e800570c600000070c60000 gcpxp4lun
360060e8010052c40052faf740000 ams2k1lun
EOF

Now you can easily spit out the GPFS cluster data you need:

[root@linuscs107 ~]# ./gpfsmapper -c gpfsmapper.conf -d
dm-0:linuscs107.gsc.wustl.edu,linuscs108.gsc.wustl.edu,linuscs109.gsc.wustl.edu::dataAndMetadata::ams2k1lun0000
dm-1:linuscs108.gsc.wustl.edu,linuscs109.gsc.wustl.edu,linuscs107.gsc.wustl.edu::dataAndMetadata::ams2k1lun0001
dm-2:linuscs109.gsc.wustl.edu,linuscs107.gsc.wustl.edu,linuscs108.gsc.wustl.edu::dataAndMetadata::ams2k1lun0002
dm-3:linuscs107.gsc.wustl.edu,linuscs108.gsc.wustl.edu,linuscs109.gsc.wustl.edu::dataAndMetadata::ams2k1lun0003
dm-4:linuscs108.gsc.wustl.edu,linuscs109.gsc.wustl.edu,linuscs107.gsc.wustl.edu::dataAndMetadata::ams2k1lun0004
dm-5:linuscs109.gsc.wustl.edu,linuscs107.gsc.wustl.edu,linuscs108.gsc.wustl.edu::dataAndMetadata::ams2k1lun0005
dm-6:linuscs107.gsc.wustl.edu,linuscs108.gsc.wustl.edu,linuscs109.gsc.wustl.edu::dataAndMetadata::ams2k1lun0006
dm-7:linuscs108.gsc.wustl.edu,linuscs109.gsc.wustl.edu,linuscs107.gsc.wustl.edu::dataAndMetadata::ams2k1lun0007
dm-8:linuscs109.gsc.wustl.edu,linuscs107.gsc.wustl.edu,linuscs108.gsc.wustl.edu::dataAndMetadata::ams2k1lun0008

Or a multipath.conf file:

> ./gpfsmapper -c gpfsmapper.conf -m
... keeps the top of /etc/multipath.conf ...
... and adds the multipaths section ...
multipaths {
  multipath {
    wwid 360060e8010052c40052faf7400000000
    alias ams2k1lun0000
  }
  multipath {
    wwid 360060e8010052c40052faf7400000001
    alias ams2k1lun0001
  }
  multipath {
    wwid 360060e8010052c40052faf7400000002
    alias ams2k1lun0002
  }
  multipath {
    wwid 360060e8010052c40052faf7400000003
    alias ams2k1lun0003
  }
  multipath {
    wwid 360060e8010052c40052faf7400000004
    alias ams2k1lun0004
  }
  multipath {
    wwid 360060e8010052c40052faf7400000005
    alias ams2k1lun0005
  }
  multipath {
    wwid 360060e8010052c40052faf7400000006
    alias ams2k1lun0006
  }
  multipath {
    wwid 360060e8010052c40052faf7400000007
    alias ams2k1lun0007
  }
  multipath {
    wwid 360060e8010052c40052faf7400000008
    alias ams2k1lun0008
  }
}


